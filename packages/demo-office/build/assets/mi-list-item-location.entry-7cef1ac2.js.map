{"version":3,"file":"mi-list-item-location.entry-7cef1ac2.js","sources":["../../../components/dist/esm/mi-list-item-location.entry.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, H as Host } from './index-7e9696f3.js';\nimport { m as midtIcon } from './icon-b8d01d6f.js';\nimport { b as appendMapsIndoorsImageQueryParameters } from './utils-ae714467.js';\n\nconst listItemLocationCss = \"html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}:host{padding:16px;font-size:1rem;font-weight:500;line-height:1rem;transition:300ms ease;font-family:-apple-system, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, Oxygen, Ubuntu, Cantarell, \\\"Fira Sans\\\", \\\"Droid Sans\\\", \\\"Helvetica Neue\\\", Arial, sans-serif, \\\"Apple Color Emoji\\\", \\\"Segoe UI Emoji\\\", \\\"Segoe UI Symbol\\\";border-radius:8px;background-color:#f9fafb;display:flex;flex-direction:row;align-items:center;cursor:pointer;gap:16px;border:1px solid #e5e7eb}:host(:hover),:host(.hovered){background-color:var(--tailwind-colors-gray-200);border:1px solid #d1d5db}.img-container{width:32px;height:32px;display:flex;justify-content:center;align-items:center}img{border-radius:8px;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.details{padding-right:16px;flex:1;display:grid;gap:4px}.details-title{margin:0;padding:0}.distance{font-weight:400}mi-location-info{color:#6b7280}\";\n\nconst ListItemLocation = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.locationClicked = createEvent(this, \"locationClicked\", 7);\n    this.listItemDidRender = createEvent(this, \"listItemDidRender\", 7);\n    this.iconDisplaySize = parseInt(midtIcon.icon.size.medium.value);\n    this.location = undefined;\n    this.showExternalId = true;\n    this.unit = undefined;\n    this.icon = undefined;\n    this.level = 'Level';\n    this.iconBadge = undefined;\n    this.iconBadgeValue = undefined;\n    this.iconURLToRender = undefined;\n  }\n  iconChanged() {\n    var _a;\n    this.iconURLToRender = this.icon ? this.icon : (_a = this.location) === null || _a === void 0 ? void 0 : _a.properties.imageURL;\n    this.updateBadge();\n  }\n  iconBadgeChanged() {\n    this.updateBadge();\n  }\n  iconBadgeValueChanged() {\n    this.updateBadge();\n  }\n  /**\n   * @description Emits the location to event listeners.\n   * @param {*} location - Location object.\n   * @memberof List\n   */\n  locationClickedHandler(location) {\n    this.locationClicked.emit(location);\n  }\n  /**\n   * Called once just after the component is first connected to the DOM.\n   */\n  componentWillLoad() {\n    var _a;\n    this.iconURLToRender = this.icon ? this.icon : (_a = this.location) === null || _a === void 0 ? void 0 : _a.properties.imageURL;\n    this.updateBadge();\n  }\n  /**\n   * Called after every render().\n   */\n  componentDidRender() {\n    if (!this.location) {\n      return;\n    }\n    this.infoElement.location = this.location;\n    this.listItemDidRender.emit();\n    // IE fallback for 'object-fit' css property\n    if (this.imageElement && 'objectFit' in document.documentElement.style === false) {\n      this.objectFitImage(this.imageElement);\n    }\n  }\n  /**\n   * Apply badge to location icon.\n   */\n  updateBadge() {\n    if (this.iconBadge && this.iconBadgeValue && this.iconURLToRender) {\n      this.applyBadgeToIcon();\n    }\n  }\n  /**\n   * @description Set image as background image.\n   * @param {HTMLImageElement} image\n   */\n  objectFitImage(image) {\n    image.setAttribute('style', `background: no-repeat center center url(\"${this.iconURLToRender}\"); background-size: cover;`);\n    image.src = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${image.width}' height='${image.height}'%3E%3C/svg%3E`;\n  }\n  /**\n   * Apply badge to location icon.\n   * Will make the original icon appear the intended size even though the badge exceeds its bounds.\n   */\n  applyBadgeToIcon() {\n    let originalIconScale;\n    this.iconURLToRender = this.icon ? this.icon : this.location.properties.imageURL;\n    const iconURL = appendMapsIndoorsImageQueryParameters(this.iconURLToRender, this.iconDisplaySize);\n    this.getImageFromUrl(iconURL).then(image => {\n      originalIconScale = image.width / 24;\n      switch (this.iconBadge.toLowerCase()) {\n        case 'availability':\n          if (this.iconBadgeValue === 'true') {\n            return mapsindoors.BadgeRenderer.AvailableBadge.overlay(image);\n          }\n          else if (this.iconBadgeValue === 'false') {\n            return mapsindoors.BadgeRenderer.UnavailableBadge.overlay(image);\n          }\n          break;\n        case 'occupancy':\n          return mapsindoors.BadgeRenderer.TextBadge.overlay(image, {\n            text: this.iconBadgeValue.toString()\n          });\n      }\n    }).then(badgedImage => {\n      if (badgedImage) {\n        this.iconURLToRender = badgedImage.src;\n        // Badged image must be moved so the original image aligns with other.\n        const translateIcon = (badgedImage.width - 24) / -2;\n        this.iconAttributes = {\n          style: {\n            transform: 'translateX(' + translateIcon + 'px)',\n            width: badgedImage.width / originalIconScale + 'px',\n            height: badgedImage.height / originalIconScale + 'px'\n          }\n        };\n      }\n    });\n  }\n  /**\n   * Create and return an Image from URL.\n   *\n   * @param {string} url\n   * @returns {Image}\n   */\n  async getImageFromUrl(url) {\n    return fetch(url)\n      .then(res => res.blob())\n      .then(blob => URL.createObjectURL(blob))\n      .then(objUrl => {\n      return new Promise((resolve) => {\n        const image = new Image();\n        image.width = this.iconDisplaySize;\n        image.height = this.iconDisplaySize;\n        image.onload = () => resolve(image);\n        image.onerror = () => resolve(null);\n        image.src = objUrl;\n      });\n    });\n  }\n  /**\n   * Render location list-item.\n   *\n   * @description Render location list-item.\n   * @returns {JSX.Element}\n   */\n  render() {\n    return this.location && (h(Host, { role: \"listitem\", onClick: () => this.locationClickedHandler(this.location) }, this.iconURLToRender ? this.renderIcon() : null, h(\"div\", { class: \"details\" }, h(\"p\", { class: \"details-title\" }, this.location.properties.name), h(\"mi-location-info\", { level: this.level, ref: (el) => this.infoElement = el, showExternalId: this.showExternalId })), this.location.properties.geodesicDistance && this.renderDistance()));\n  }\n  /**\n   * @description Get JSX template for icon.\n   * @returns {JSX.Element}\n   */\n  renderIcon() {\n    const iconURL = appendMapsIndoorsImageQueryParameters(this.iconURLToRender, this.iconDisplaySize);\n    return (h(\"div\", { class: \"img-container\" }, h(\"img\", Object.assign({}, this.iconAttributes, { ref: (el) => this.imageElement = el, src: iconURL }))));\n  }\n  /**\n   * @description Get JSX template for distance.\n   * @returns {JSX.Element}\n   */\n  renderDistance() {\n    return (h(\"div\", { class: \"distance\" }, h(\"mi-distance\", { meters: this.location.properties.geodesicDistance, unit: this.unit })));\n  }\n  static get watchers() { return {\n    \"icon\": [\"iconChanged\"],\n    \"iconBadge\": [\"iconBadgeChanged\"],\n    \"iconBadgeValue\": [\"iconBadgeValueChanged\"]\n  }; }\n};\nListItemLocation.style = listItemLocationCss;\n\nexport { ListItemLocation as mi_list_item_location };\n"],"names":["listItemLocationCss","ListItemLocation","hostRef","registerInstance","createEvent","midtIcon","_a","location","image","originalIconScale","iconURL","appendMapsIndoorsImageQueryParameters","badgedImage","translateIcon","url","res","blob","objUrl","resolve","h","Host","el"],"mappings":"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"}